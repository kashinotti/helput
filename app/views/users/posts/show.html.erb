<div>
  <h1>投稿詳細画面</h1>
    <div id="post_<%= @post.id %>">
      <%= render partial: 'users/posts/post', locals: { post: @post, like: @like } %>
    </div>
</div>

<div>
  <h1>コメント</h1>

  <div>
    <% @comments.each do |comment| %>
      <p>
        <%= comment.user.name %>
      </p>
      <p>
        <%= comment.comment %>
      </p>

      <div class="reply_area">
        <% comment.replies.order(:created_at).each do |reply| %>
          <p>
            <%= reply.user.name %>
          </p>
          <p>
            <%= reply.comment %>
          </p>
        <% end %>
      </div>
      <div>
        <%= form_with(model:[@post, @comment_reply], url: post_comments_path(@post.id), local: true) do |f| %>

          <%= f.hidden_field :parent_id, value: comment.id %>
          <%= f.hidden_field :post_id, value: @post.id %>
          <%= f.text_area :comment %>

          <%= f.submit "返信する" %>
        <% end %>
      </div>


    <% end %>
  </div>
</div>


<div>
  <%= form_with(model:[@post, @comment], url: post_comments_path(@post.id), method: :post, local: true) do |f| %>

    <%= f.hidden_field :post_id, value: @post.id %>

    <%= f.text_area :comment %>

    <%= f.submit "投稿する" %>

  <% end %>
</div>
